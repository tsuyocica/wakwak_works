<div class="container chat-container d-flex flex-column mt-4" style="max-width: 960px;">
  <div class="card shadow-sm p-4 d-flex flex-column flex-grow-1">
    <!-- âœ… ãƒãƒ£ãƒƒãƒˆã®ã‚¿ã‚¤ãƒˆãƒ« -->
    <div class="d-flex align-items-center border-bottom pb-2">
      <!-- âœ… ãƒ¡ã‚¤ãƒ³ç”»åƒï¼ˆã‚¢ã‚¤ã‚³ãƒ³åŒ–ï¼‰ -->
      <div class="me-3">
        <% if @chat.job_post.main_image.attached? %>
          <%= image_tag @chat.job_post.main_image.variant(resize_to_fill: [50, 50]), class: "rounded-circle", alt: "æ¡ˆä»¶ç”»åƒ" %>
        <% else %>
          <%= image_tag "noimage.png", class: "rounded-circle", alt: "ç”»åƒãªã—", width: 50, height: 50 %>
        <% end %>
      </div>

      <!-- âœ… ä½œæ¥­ä»¶å -->
      <h5 class="fw-bold flex-grow-1 text-center">
        ã€Š <%= @chat.job_post.work_title %> ã€‹
      </h5>

      <!-- âœ… ç›¸æ‰‹ã®åå‰ -->
      <div class="fw-bold text-end">
        <%= @partner.username %>
      </div>
    </div>

    <!-- âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§ -->
    <div class="messages-list flex-grow-1 overflow-auto mt-3" id="messages">
      <% @messages.each do |message_data| %>
        <%= render "messages/message_content", message: message_data[:message], sender_id: message_data[:sender_id] %>
      <% end %>
    </div>
  </div>

  <!-- âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ãƒ•ã‚©ãƒ¼ãƒ  -->
  <div class="chat-form mb-3" id="message-form">
    <%= form_with(model: [@chat, Message.new], local: false, html: { multipart: true }) do |f| %>
      <div class="input-group">
        <%= f.text_area :content, class: "form-control", placeholder: "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›" %>
        <%= f.file_field :images, multiple: true, class: "form-control-file d-none", id: "image-upload" %>
        <%= f.file_field :files, multiple: true, class: "form-control-file d-none", id: "file-upload" %>
        <button type="button" class="btn btn-outline-secondary" onclick="document.getElementById('image-upload').click()">ğŸ“·</button>
        <button type="button" class="btn btn-outline-secondary" onclick="document.getElementById('file-upload').click()">ğŸ“</button>
        <%= f.submit "é€ä¿¡", class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>

<!-- âœ… CSSï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ä½ç½®èª¿æ•´ï¼‰ -->
<style>
  .messages-list {
    padding-right: 10px; /* âœ… å³å´ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç¢ºä¿ã—ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’é…ç½® */
  }

  /* âœ… ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ */
  .messages-list::-webkit-scrollbar {
    width: 8px; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®å¹… */
  }

  .messages-list::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.2); /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®è‰² */
    border-radius: 4px;
  }

  .messages-list::-webkit-scrollbar-track {
    background-color: transparent; /* èƒŒæ™¯ã‚’é€æ˜ã« */
  }
</style>