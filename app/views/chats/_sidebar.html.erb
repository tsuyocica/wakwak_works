<div class="col-md-3 bg-light p-3 border-end">
  <h5 class="fw-bold">💬 チャット一覧</h5>
  <ul class="list-group">
    <% if @chat_list.present? %>
      <% @chat_list.each do |chat| %>
        <% if current_user.role.include?("施工管理者") %>
          <% partner = chat.worker %> <!-- 施工管理者は承認済み作業員の名前を表示 -->
          <% chat_label = partner.username %>
        <% else %>
          <% partner = chat.owner %> <!-- 作業員は案件名＋施工管理者を表示 -->
          <% chat_label = "#{chat.job_post.work_title} - #{partner.username}" %>
        <% end %>

        <% if partner.present? %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <%= link_to chat_path(chat), class: "text-dark d-flex align-items-center w-100 text-decoration-none" do %>
              <div class="me-2">
                <i class="bi bi-person-circle"></i> <!-- アイコン -->
              </div>
              <span class="fw-bold"><%= chat_label %></span>
            <% end %>
            <span class="badge bg-secondary"><%= time_ago_in_words(chat.updated_at) %>前</span>
          </li>
        <% end %>
      <% end %>
    <% else %>
      <li class="list-group-item text-muted">チャットがありません</li>
    <% end %>
  </ul>
</div>